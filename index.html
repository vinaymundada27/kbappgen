<!DOCTYPE html>
<html>
<head>
    <link href="css/metro.css" rel="stylesheet">
    <link href="css/metro-icons.css" rel="stylesheet">
    <link href="css/metro-responsive.css" rel="stylesheet">
    <link href="css/metro-rtl.css" rel="stylesheet">
    <link href="css/metro-schemes.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <!-- <script src="jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="js/metro.js"></script>
    <script src="js/jquery-ui/jquery-ui.min.js"></script>
    <script>
        created_ids = [];
        screens = {
        	"input" : {

        	},
        	"review" : {

        	},
        	"kbe" : {

        	},
        	"final" : {

        	}
        }
        properties = {
        	"textInput": ["title", "placeholder"],
        	"checkboxes": ["title", "names"],
        	"radioButtons": ["title", "names"],
        	"switchers": ["title"],
        	"textBox": ["title"],
        	"multiSelect": ["title", "names"],
        	"fileUpload": ["title"],
        	"buttons": ["title"],
        	"sliders": ["title"]
        }
        function update_element(element_id) {
            text_id = (element_id.split('-')[1]);      
            title_val = $(element_id).children(".input-control").children(".title-input").val();           
            place_val = $(element_id).children(".input-control").children(".placeholder-input").val();
            multi_val = $(element_id).children(".input-control").children(".multi-input").val();

            class_type = $("#" + text_id).prop('class').split(" ")[0];

            $("#" + text_id + " > " + "label:first-child").text(title_val);

            if (class_type == "textInput") {     
              $("#" + text_id).children(".input-control").children("input").prop("placeholder", place_val);
            }
            else if (class_type == "checkboxes") {
              $("#" + text_id).children(".input-control").remove();
              check_labels = multi_val.split(",").map(function(label) {
              	return '<label class="input-control checkbox small-check">' +
              	       '<input type="checkbox" checked>' +
              	       '<span class="check"></span>' +
              	       '<span class="caption">' + label + '</span>' +
              	       '</label>'
              }).join("");
              $("#" + text_id).append(check_labels);
            }
            else if (class_type == "radioButtons") {
            	$("#" + text_id).children(".input-control").remove();
            	radio_labels = multi_val.split(",").map(function(label) {
            		return '<label class="input-control radio small-check">' +
			               '<input type="radio">' +
			               '<span class="check"></span>' +
			               '<span class="caption">' + label + '</span>' +
			               '</label>';
            	}).join("");
            	$("#" + text_id).append(radio_labels);
            }
            else if (class_type == "multiSelect") {
            	$("#" + text_id + " select").children().remove();
            	select_labels = multi_val.split(",").map(function(label) {
                    return '<option>' + label + '</option>';
            	}).join("");
            	$("#" + text_id + " select").append(select_labels);
            }
            else if (class_type == "buttons") {
            	$("#" + text_id + " input").prop("value", title_val);
            	$("#" + text_id + " > label").remove();
            }
        }
        function delete_element(id) {
        	$("#" + id).remove();
        	$("#dialog-" + id).remove();
        }
        function generate_html(type, option) {
        	if (option == "title") {
        	   return '<label>Enter title: </label>' +
        	  '<div class="input-control text"><input type="text" class="title-input"></div><div></div>'
        	}
        	else if (option == "placeholder") {
        		return '<label>Enter placeholder: </label>' +
        	  '<div class="input-control text"><input type="text" class="placeholder-input"></div><div></div>'
        	}
        	else if (option == "names") {
        		return '<label>Enter various values(seperate by commas): </label>' +
        		'<div class="input-control text"><input type="text" class="multi-input"></div><div></div>'
        	}
        }
        function generate_dialog(type, id) {
        	header_str = '<div data-role="dialog" id="' + id +'" class="padding20" data-close-button="true">';
        	body_str = properties[type].map(function (opt) {
        		return generate_html(type, opt);
        	}).join("");
        	footer_str = '<button class="button" id="button-' + ((id.split('-')[1]) + '') + '">Save</button>'
        	           + '<button class="button" id="delete-' + ((id.split('-')[1]) + '') + '">Delete</button>'
        	           + '</div>';
        	return header_str + body_str + footer_str;
        }
        function showDialog(id){
          var dialog = $(id).data('dialog');
          dialog.open();
        }
		$(function() {
		  $( ".draggable" ).draggable({
		      appendTo: "body",
		      helper: "clone"
		   });
		  $( ".droppable" ).droppable({
		  	drop: function(event, ui) {
		  		var copy_el = ui.draggable.clone();
		  		new_id = Math.floor((Math.random() * 100000) + 1);
		  		copy_el.prop('id', (new_id + ''));
		  		copy_el.appendTo( this );
		  		class_type = copy_el.prop('class').split(" ")[0];
		  		copy_el.append(generate_dialog(class_type, "dialog" + "-" + new_id));
		  		created_ids.push(new_id);
		  		refresh_events();
		  	}
		  });
		});
		function refresh_events() {
			created_ids.map(function(id) {
			  $("#" + id).dblclick(function() {
				showDialog("#dialog" + "-" + id);
			  });
			  $("#button-"+ id).click(function() {
				update_element("#dialog" + "-" + id);
			  });
			  $("#delete-" + id).click(function() {
			  	delete_element(id);
			  });
		    });
		}
	</script>
</head>
<body>
  <div class="grid">
    <div class="row cells4">
        <div class="cell" id="input-cell">
        	<h2>Input elements:</h2>
        	<div id="textInputDiv" class="textInput draggable">
        	  <label>Text input:</label>
        	  <div class="input-control text">
                 <input type="text" placeholder="Input your text here...">
              </div>
            </div>
            <div id="checkboxes" class="checkboxes draggable">
                <label>Checkboxes: </label>
            	<label class="input-control checkbox small-check">
				  <input type="checkbox" checked>
				  <span class="check"></span>
				  <span class="caption">Checkbox</span>
				</label>
				<label class="input-control checkbox small-check">
				  <input type="checkbox" checked>
				  <span class="check"></span>
				  <span class="caption">Checkbox</span>
				</label>
            </div>
            <div id="radioButtonsDiv" class="radioButtons draggable">
              <label>Radio buttons: </label>
              <label class="input-control radio small-check">
			    <input type="radio">
			    <span class="check"></span>
			    <span class="caption">Small radio</span>
			  </label>
			  <label class="input-control radio small-check">
			    <input type="radio">
			    <span class="check"></span>
			    <span class="caption">Small radio</span>
			  </label>
            </div>
            <div id="switchersDiv" class="switchers draggable">
              <label>Switcher: </label>
              <label class="switch-original">
			    <input type="checkbox">
			    <span class="check"></span>
			  </label>
            </div>
            <div id="textBoxDiv" class="textBox draggable">
              <label>Textbox: </label>
              <div class="input-control textarea">
			    <textarea></textarea>
			  </div>
            </div>
            <div id="multiSelectDiv" class="multiSelect draggable">
              <label>Selection: </label>
              <div class="input-control select">
				<select>
				  <option>1</option>
				  <option>2</option>
				  <option>3</option>
				</select>
			  </div>
            </div>
            <div id="fileUploadDiv" class="fileUpload draggable">
              <div class="input-control file" data-role="input">
                <label>File Upload: </label>
			    <input type="file">
			    <button class="button"><span class="mif-folder"></span></button>
			  </div>
            </div>
            <div id="buttonsDiv" class="buttons draggable">
              <label>Button: </label>
              <input type="button" value="Button">
            </div>
            <div id="slidersDiv" class="sliders draggable">
               <label>Sliders: </label>
               <div class="slider" data-role="slider"></div>
            </div>
        </div>
        <div class="cell colspan2 droppable" style="height: 600px;">
        	<h2>Drop here</h2>
        </div>
        <div class="cell">
            <h2>Status</h2>
            <h4>Current screen: Input</h4>
            <input type="button" value="Save Screen">
            <div></div>
            <input type="button" value="Next Screen">
            <input type="button" value="Prev Screen">
        </div>
    </div>
  </div>
</body>
</html>
